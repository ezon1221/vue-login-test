<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/security 
        http://www.springframework.org/schema/security/spring-security-3.2.xsd
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans.xsd">

    <!-- 메모리 기반 사용자 인증 -->
    <authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="tester" password="pswd1234" authorities="ROLE_USER" />
            </user-service>
        </authentication-provider>
    </authentication-manager>

    <!-- URL 보호 및 로그인 설정 -->
    <http auto-config="true" use-expressions="true">
        <!-- 정적 리소스와 로그인 관련 경로 허용 -->
        <intercept-url pattern="/" access="permitAll" />
        <intercept-url pattern="/index.html" access="permitAll" />
        <intercept-url pattern="/js/**" access="permitAll" />
        <intercept-url pattern="/css/**" access="permitAll" />
        <intercept-url pattern="/images/**" access="permitAll" />
        <intercept-url pattern="/login" access="permitAll" />

        <!-- 나머지 URL은 인증 필요 -->
        <intercept-url pattern="/**" access="hasRole('ROLE_USER')" />

        <!-- 로그인 설정 -->
		<form-login
		    login-page="/index.html"
		    login-processing-url="/login"
		    username-parameter="username"
		    password-parameter="password"
		    authentication-success-handler-ref="authSuccessHandler"
		    authentication-failure-handler-ref="authFailureHandler" />


        <!-- 로그아웃 설정 -->
        <logout logout-url="/logout" logout-success-url="/index.html?logout=true" />
    </http>
		<beans:bean id="authSuccessHandler" class="com.spa.security.LoginSuccessHandler" />
		<beans:bean id="authFailureHandler" class="com.spa.security.LoginFailureHandler" />
</beans:beans>
